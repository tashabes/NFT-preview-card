!function(t){sedition.Facebook={bindConnectButtonClick:function(){t(".js-fb-connect").each(function(){var e=t(this);e.click(function(t){if(t.preventDefault(),e.is(".js-fb-signup")){var n=e.closest("form");if(!sedition.Facebook.validateFacebookSignupForm(n))return}e.attr("disabled","disabled"),sedition.Facebook.login(t)})})},validateFacebookSignupForm:function(e){var n=e.data("validation"),i=e.find("input.js-user-terms");return _.every(i,function(e){return n.validateField(t(e))})},login:function(){sedition.Modal&&sedition.Modal.show(t(".fb-connecting-template").html());var e=t(this),n="email";FB.login(function(n){var i=e.data("callback");n.authResponse?e.data("js-callback")?t.get(i):window.location="/auth/facebook/callback?"+t.param({signed_request:n.authResponse.signedRequest}):sedition.Modal&&(e.trigger("cancel"),sedition.Modal.hide())},{scope:n})}}}(jQuery),
/*
 * jQuery UI Widget 1.10.0+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,n){var i=0,o=Array.prototype.slice,a=t.cleanData;t.cleanData=function(n){for(var i,o=0;null!=(i=n[o]);o++)try{t(i).triggerHandler("remove")}catch(e){}a(n)},t.widget=function(e,n,i){var o,a,r,s,l={},c=e.split(".")[0];e=e.split(".")[1],o=c+"-"+e,i||(i=n,n=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[c]=t[c]||{},a=t[c][e],r=t[c][e]=function(t,e){if(!this._createWidget)return new r(t,e);arguments.length&&this._createWidget(t,e)},t.extend(r,a,{version:i.version,_proto:t.extend({},i),_childConstructors:[]}),(s=new n).options=t.widget.extend({},s.options),t.each(i,function(e,i){var o,a;t.isFunction(i)?l[e]=(o=function(){return n.prototype[e].apply(this,arguments)},a=function(t){return n.prototype[e].apply(this,t)},function(){var t,e=this._super,n=this._superApply;return this._super=o,this._superApply=a,t=i.apply(this,arguments),this._super=e,this._superApply=n,t}):l[e]=i}),r.prototype=t.widget.extend(s,{widgetEventPrefix:a?s.widgetEventPrefix:e},l,{constructor:r,namespace:c,widgetName:e,widgetFullName:o}),a?(t.each(a._childConstructors,function(e,n){var i=n.prototype;t.widget(i.namespace+"."+i.widgetName,r,n._proto)}),delete a._childConstructors):n._childConstructors.push(r),t.widget.bridge(e,r)},t.widget.extend=function(e){for(var i,a,r=o.call(arguments,1),s=0,l=r.length;s<l;s++)for(i in r[s])a=r[s][i],r[s].hasOwnProperty(i)&&a!==n&&(t.isPlainObject(a)?e[i]=t.isPlainObject(e[i])?t.widget.extend({},e[i],a):t.widget.extend({},a):e[i]=a);return e},t.widget.bridge=function(e,i){var a=i.prototype.widgetFullName||e;t.fn[e]=function(r){var s="string"==typeof r,l=o.call(arguments,1),c=this;return r=!s&&l.length?t.widget.extend.apply(null,[r].concat(l)):r,s?this.each(function(){var i,o=t.data(this,a);return o?t.isFunction(o[r])&&"_"!==r.charAt(0)?(i=o[r].apply(o,l))!==o&&i!==n?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+r+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=t.data(this,a);e?e.option(r||{})._init():t.data(this,a,new i(r,this))}),c}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var o,a,r,s=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(s={},e=(o=e.split(".")).shift(),o.length){for(a=s[e]=t.widget.extend({},this.options[e]),r=0;r<o.length-1;r++)a[o[r]]=a[o[r]]||{},a=a[o[r]];if(e=o.pop(),i===n)return a[e]===n?null:a[e];a[e]=i}else{if(i===n)return this.options[e]===n?null:this.options[e];s[e]=i}return this._setOptions(s),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,n,i){var o,a=this;"boolean"!=typeof e&&(i=n,n=e,e=!1),i?(n=o=t(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),t.each(i,function(i,r){function s(){if(e||!0!==a.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof r?a[r]:r).apply(a,arguments)}"string"!=typeof r&&(s.guid=r.guid=r.guid||s.guid||t.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+a.eventNamespace,d=l[2];d?o.delegate(d,c,s):n.bind(c,s)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function n(){return("string"==typeof t?i[t]:t).apply(i,arguments)}var i=this;return setTimeout(n,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,n,i){var o,a,r=this.options[e];if(i=i||{},(n=t.Event(n)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],a=n.originalEvent)for(o in a)o in n||(n[o]=a[o]);return this.element.trigger(n,i),!(t.isFunction(r)&&!1===r.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(i,o,a){"string"==typeof o&&(o={effect:o});var r,s=o?!0===o||"number"==typeof o?n:o.effect||n:e;"number"==typeof(o=o||{})&&(o={duration:o}),r=!t.isEmptyObject(o),o.complete=a,o.delay&&i.delay(o.delay),r&&t.effects&&t.effects.effect[s]?i[e](o):s!==e&&i[s]?i[s](o.duration,o.easing,a):i.queue(function(n){t(this)[e](),a&&a.call(i[0]),n()})}})}),
/*
 * jQuery Iframe Transport Plugin 1.6.1
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery)}(function(t){"use strict";var n=0;t.ajaxTransport("iframe",function(i){var o,a,r;if(i.async)return{send:function(s,l){(o=t('<form style="display:none;"></form>')).attr("accept-charset",i.formAcceptCharset),r=/\?/.test(i.url)?"&":"?","DELETE"===i.type?(i.url=i.url+r+"_method=DELETE",i.type="POST"):"PUT"===i.type?(i.url=i.url+r+"_method=PUT",i.type="POST"):"PATCH"===i.type&&(i.url=i.url+r+"_method=PATCH",i.type="POST"),a=t('<iframe src="javascript:false;" name="iframe-transport-'+(n+=1)+'"></iframe>').bind("load",function(){var n,r=t.isArray(i.paramName)?i.paramName:[i.paramName];a.unbind("load").bind("load",function(){var n;try{if(!(n=a.contents()).length||!n[0].firstChild)throw new Error}catch(e){n=undefined}l(200,"success",{iframe:n}),t('<iframe src="javascript:false;"></iframe>').appendTo(o),o.remove()}),o.prop("target",a.prop("name")).prop("action",i.url).prop("method",i.type),i.formData&&t.each(i.formData,function(e,n){t('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(o)}),i.fileInput&&i.fileInput.length&&"POST"===i.type&&(n=i.fileInput.clone(),i.fileInput.after(function(t){return n[t]}),i.paramName&&i.fileInput.each(function(e){t(this).prop("name",r[e]||i.paramName)}),o.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),o.submit(),n&&n.length&&i.fileInput.each(function(e,i){var o=t(n[e]);t(i).prop("name",o.prop("name")),o.replaceWith(i)})}),o.append(a).appendTo(document.body)},abort:function(){a&&a.unbind("load").prop("src","javascript".concat(":false;")),o&&o.remove()}}}),t.ajaxSetup({converters:{"iframe text":function(e){return e&&t(e[0].body).text()},"iframe json":function(e){return e&&t.parseJSON(t(e[0].body).text())},"iframe html":function(e){return e&&t(e[0].body).html()},"iframe script":function(e){return e&&t.globalEval(t(e[0].body).text())}}})}),
/*
 * jQuery File Upload Plugin 5.21
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],t):t(window.jQuery)}(function(t){"use strict";t.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),t.support.xhrFormDataFileUpload=!!window.FormData,t.propHooks.elements={get:function(e){return t.nodeName(e,"form")?t.grep(e.elements,function(e){return!t.nodeName(e,"input")||"file"!==e.type}):null}},t.widget("blueimp.fileupload",{options:{dropZone:t(document),pasteZone:t(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(t){return t.serializeArray()},add:function(t,e){e.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,n){var i=t-this.timestamp;return(!this.bitrate||!n||i>n)&&(this.bitrate=(e-this.loaded)*(1e3/i)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&t.support.xhrFileUpload||t.support.xhrFormDataFileUpload)},_getFormData:function(e){var n;return"function"==typeof e.formData?e.formData(e.form):t.isArray(e.formData)?e.formData:e.formData?(n=[],t.each(e.formData,function(t,e){n.push({name:t,value:e})}),n):[]},_getTotal:function(e){var n=0;return t.each(e,function(t,e){n+=e.size||1}),n},_onProgress:function(t,e){if(t.lengthComputable){var n,i,o=+new Date;if(e._time&&e.progressInterval&&o-e._time<e.progressInterval&&t.loaded!==t.total)return;e._time=o,n=e.total||this._getTotal(e.files),i=parseInt(t.loaded/t.total*(e.chunkSize||n),10)+(e.uploadedBytes||0),this._loaded+=i-(e.loaded||e.uploadedBytes||0),e.lengthComputable=!0,e.loaded=i,e.total=n,e.bitrate=e._bitrateTimer.getBitrate(o,i,e.bitrateInterval),this._trigger("progress",t,e),this._trigger("progressall",t,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(o,this._loaded,e.bitrateInterval)})}},_initProgressListener:function(e){var n=this,i=e.xhr?e.xhr():t.ajaxSettings.xhr();i.upload&&(t(i.upload).bind("progress",function(t){var i=t.originalEvent;t.lengthComputable=i.lengthComputable,t.loaded=i.loaded,t.total=i.total,n._onProgress(t,e)}),e.xhr=function(){return i})},_initXHRData:function(e){var n,i=e.files[0],o=e.multipart||!t.support.xhrFileUpload,a=e.paramName[0];e.headers=e.headers||{},e.contentRange&&(e.headers["Content-Range"]=e.contentRange),o?t.support.xhrFormDataFileUpload&&(e.postMessage?(n=this._getFormData(e),e.blob?n.push({name:a,value:e.blob}):t.each(e.files,function(t,i){n.push({name:e.paramName[t]||a,value:i})})):(e.formData instanceof FormData?n=e.formData:(n=new FormData,t.each(this._getFormData(e),function(t,e){n.append(e.name,e.value)})),e.blob?(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"',n.append(a,e.blob,i.name)):t.each(e.files,function(t,i){(window.Blob&&i instanceof Blob||window.File&&i instanceof File)&&n.append(e.paramName[t]||a,i,i.name)})),e.data=n):(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"',e.contentType=i.type,e.data=e.blob||i),e.blob=null},_initIframeSettings:function(e){e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&t("<a></a>").prop("href",e.url).prop("host")!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t,"iframe")},_getParamName:function(e){var n=t(e.fileInput),i=e.paramName;return i?t.isArray(i)||(i=[i]):(i=[],n.each(function(){for(var e=t(this),n=e.prop("name")||"files[]",o=(e.prop("files")||[1]).length;o;)i.push(n),o-=1}),i.length||(i=[n.prop("name")||"files[]"])),i},_initFormSettings:function(e){e.form&&e.form.length||(e.form=t(e.fileInput.prop("form")),e.form.length||(e.form=t(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var n=t.extend({},this.options,e);return this._initFormSettings(n),this._initDataSettings(n),n},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(e,n,i){var o=t.Deferred(),a=o.promise();return n=n||this.options.context||a,!0===e?o.resolveWith(n,i):!1===e&&o.rejectWith(n,i),a.abort=o.promise,this._enhancePromise(a)},_getUploadedBytes:function(t){var e=t.getResponseHeader("Range"),n=e&&e.split("-"),i=n&&n.length>1&&parseInt(n[1],10);return i&&i+1},_chunkedUpload:function(e,n){var i,o,a=this,r=e.files[0],s=r.size,l=e.uploadedBytes=e.uploadedBytes||0,c=e.maxChunkSize||s,d=r.slice||r.webkitSlice||r.mozSlice,u=t.Deferred(),f=u.promise();return!(!(this._isXHRUpload(e)&&d&&(l||c<s))||e.data)&&(!!n||(l>=s?(r.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,e.context,[null,"error",r.error])):(o=function(){var n=t.extend({},e);n.blob=d.call(r,l,l+c,r.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+l+"-"+(l+n.chunkSize-1)+"/"+s,a._initXHRData(n),a._initProgressListener(n),i=(!1!==a._trigger("chunksend",null,n)&&t.ajax(n)||a._getXHRPromise(!1,n.context)).done(function(i,r,c){l=a._getUploadedBytes(c)||l+n.chunkSize,(!n.loaded||n.loaded<n.total)&&a._onProgress(t.Event("progress",{lengthComputable:!0,loaded:l-n.uploadedBytes,total:l-n.uploadedBytes}),n),e.uploadedBytes=n.uploadedBytes=l,n.result=i,n.textStatus=r,n.jqXHR=c,a._trigger("chunkdone",null,n),a._trigger("chunkalways",null,n),l<s?o():u.resolveWith(n.context,[i,r,c])}).fail(function(t,e,i){n.jqXHR=t,n.textStatus=e,n.errorThrown=i,a._trigger("chunkfail",null,n),a._trigger("chunkalways",null,n),u.rejectWith(n.context,[t,e,i])})},this._enhancePromise(f),f.abort=function(){return i.abort()},o(),f)))},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=e.uploadedBytes||0,this._total+=this._getTotal(e.files)},_onDone:function(e,n,i,o){if(!this._isXHRUpload(o)||!o.loaded||o.loaded<o.total){var a=this._getTotal(o.files)||1;this._onProgress(t.Event("progress",{lengthComputable:!0,loaded:a,total:a}),o)}o.result=e,o.textStatus=n,o.jqXHR=i,this._trigger("done",null,o)},_onFail:function(t,e,n,i){i.jqXHR=t,i.textStatus=e,i.errorThrown=n,this._trigger("fail",null,i),i.recalculateProgress&&(this._loaded-=i.loaded||i.uploadedBytes||0,this._total-=i.total||this._getTotal(i.files))},_onAlways:function(t,e,n,i){this._active-=1,this._trigger("always",null,i),0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(e,n){var i,o,a,r,s=this,l=s._getAJAXSettings(n),c=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,i=i||((o||!1===s._trigger("send",e,l))&&s._getXHRPromise(!1,l.context,o)||s._chunkedUpload(l)||t.ajax(l)).done(function(t,e,n){s._onDone(t,e,n,l)}).fail(function(t,e,n){s._onFail(t,e,n,l)}).always(function(t,e,n){if(s._sending-=1,s._onAlways(t,e,n,l),l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var i=s._slots.shift();i;){if(i.state?"pending"===i.state():!i.isRejected()){i.resolve();break}i=s._slots.shift()}})};return this._beforeSend(e,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(a=t.Deferred(),this._slots.push(a),r=a.pipe(c)):r=this._sequence=this._sequence.pipe(c,c),r.abort=function(){return o=[undefined,"abort","abort"],i?i.abort():(a&&a.rejectWith(l.context,o),c())},this._enhancePromise(r)):c()},_onAdd:function(e,n){var i,o,a,r,s=this,l=!0,c=t.extend({},this.options,n),d=c.limitMultiFileUploads,u=this._getParamName(c);if((c.singleFileUploads||d)&&this._isXHRUpload(c))if(!c.singleFileUploads&&d)for(a=[],i=[],r=0;r<n.files.length;r+=d)a.push(n.files.slice(r,r+d)),(o=u.slice(r,r+d)).length||(o=u),i.push(o);else i=u;else a=[n.files],i=[u];return n.originalFiles=n.files,t.each(a||n.files,function(o,r){var c=t.extend({},n);return c.files=a?r:[r],c.paramName=i[o],c.submit=function(){return c.jqXHR=this.jqXHR=!1!==s._trigger("submit",e,this)&&s._onSend(e,this),this.jqXHR},l=s._trigger("add",e,c)}),l},_replaceFileInput:function(e){var n=e.clone(!0);t("<form></form>").append(n)[0].reset(),e.after(n).detach(),t.cleanData(e.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,i){return i===e[0]?n[0]:i}),e[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(e,n){var i=this,o=t.Deferred(),a=function(t){t&&!t.entry&&(t.entry=e),o.resolve([t])};return n=n||"",e.isFile?e._file?(e._file.relativePath=n,o.resolve(e._file)):e.file(function(t){t.relativePath=n,o.resolve(t)},a):e.isDirectory?e.createReader().readEntries(function(t){i._handleFileTreeEntries(t,n+e.name+"/").done(function(t){o.resolve(t)}).fail(a)},a):o.resolve([]),o.promise()},_handleFileTreeEntries:function(e,n){var i=this;return t.when.apply(t,t.map(e,function(t){return i._handleFileTreeEntry(t,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){var n=(e=e||{}).items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(t.map(n,function(t){var e;return t.webkitGetAsEntry?((e=t.webkitGetAsEntry())&&(e._file=t.getAsFile()),e):t.getAsEntry()})):t.Deferred().resolve(t.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){var n,i,o=(e=t(e)).prop("webkitEntries")||e.prop("entries");if(o&&o.length)return this._handleFileTreeEntries(o);if((n=t.makeArray(e.prop("files"))).length)n[0].name===undefined&&n[0].fileName&&t.each(n,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(!(i=e.prop("value")))return t.Deferred().resolve([]).promise();n=[{name:i.replace(/^.*\\/,"")}]}return t.Deferred().resolve(n).promise()},_getFileInputFiles:function(e){return e instanceof t&&1!==e.length?t.when.apply(t,t.map(e,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(e){var n=this,i={fileInput:t(e.target),form:t(e.target.form)};this._getFileInputFiles(i.fileInput).always(function(t){i.files=t,n.options.replaceFileInput&&n._replaceFileInput(i.fileInput),!1!==n._trigger("change",e,i)&&n._onAdd(e,i)})},_onPaste:function(e){var n=e.originalEvent.clipboardData,i=n&&n.items||[],o={files:[]};if(t.each(i,function(t,e){var n=e.getAsFile&&e.getAsFile();n&&o.files.push(n)}),!1===this._trigger("paste",e,o)||!1===this._onAdd(e,o))return!1},_onDrop:function(t){var e=this,n=t.dataTransfer=t.originalEvent.dataTransfer,i={};n&&n.files&&n.files.length&&t.preventDefault(),this._getDroppedFiles(n).always(function(n){i.files=n,!1!==e._trigger("drop",t,i)&&e._onAdd(t,i)})},_onDragOver:function(e){var n=e.dataTransfer=e.originalEvent.dataTransfer;if(!1===this._trigger("dragover",e))return!1;n&&-1!==t.inArray("Files",n.types)&&(n.dropEffect="copy",e.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(e,n){var i=-1!==t.inArray(e,this._refreshOptionsList);i&&this._destroyEventHandlers(),this._super(e,n),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;e.fileInput===undefined?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof t||(e.fileInput=t(e.fileInput)),e.dropZone instanceof t||(e.dropZone=t(e.dropZone)),e.pasteZone instanceof t||(e.pasteZone=t(e.pasteZone))},_create:function(){var e=this.options;t.extend(e,t(this.element[0].cloneNode(!1)).data()),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},_destroy:function(){this._destroyEventHandlers()},add:function(e){var n=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,n._onAdd(null,e)}):(e.files=t.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var n,i,o=this,a=t.Deferred(),r=a.promise();return r.abort=function(){return i=!0,n?n.abort():(a.reject(null,"abort","abort"),r)},this._getFileInputFiles(e.fileInput).always(function(t){i||(e.files=t,n=o._onSend(null,e).then(function(t,e,n){a.resolve(t,e,n)},function(t,e,n){a.reject(t,e,n)}))}),this._enhancePromise(r)}if(e.files=t.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}})}),function(t){sedition.SeditionFileUpload=function(e,n){n=n||{},this.$element=e,this.options=t.extend({},this.defaults,n),this.state="pending-selection",this.timerHandler=null,this.bitrates=[],this.secondsLeft=null,this.smoothSecondsLeft=null,this.loaded=null,this.total=null;var i={add:t.proxy(this.onAdd,this),progress:t.proxy(this.onProgress,this),done:t.proxy(this.onDone,this),fail:t.proxy(this.onFail,this),send:t.proxy(this.onSend,this),replaceFileInput:!1};i=t.extend(i,n.fileuploadOptions),e.fileupload(i),this.railsFileUpload=e.data("fileupload"),this.formData=null,this.allowedFiles=/(\.|\/)(3gp|3g2|asf|wmv|avi|mxf|dv|flv|f4v|f4p|f4a|f4b|mkv|mk3d|mka|mks|mov|mp4|ogg|ogv|oga|ogx|spx|opus|rm|vob|webm|jpe?g|png|mpe?g|m1v|mpv)$/i,this.options.allowedFiles&&(this.allowedFiles=this.options.allowedFiles)},sedition.SeditionFileUpload.prototype={defaults:{dropZone:null,ui:{container:null,fileSize:null,fileName:null,progress:null},events:{onAdd:null,onSend:null,onDone:null,onFail:null,onProgress:null,onTimeRemaining:null},fileuploadOptions:{},allowedFiles:null,autoUpload:!1},_humanizeBytes:function(t){var e=["n/a","bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=+Math.floor(Math.log(t)/Math.log(1024));return(t/Math.pow(1024,n)).toFixed(n?1:0)+" "+e[isNaN(t)?0:n+1]},_formatTime:function(t){var e=new Date(1e3*t),n=parseInt(t/86400,10);return(n=n?n+"d ":"")+("0"+e.getUTCHours()).slice(-2)+":"+("0"+e.getUTCMinutes()).slice(-2)+":"+("0"+e.getUTCSeconds()).slice(-2)},_setState:function(t){this.state=t,this.$element.attr("data-state",t),this.options.ui.container&&this.options.ui.container.attr("data-state",t)},onSend:function(t,e){this.options.events.onSend&&this.options.events.onSend.call(this,t,e)},start:function(){this._setState("uploading"),this.formData.submit(),this.options.events.onStart&&this.options.events.onStart.call(this),this.bitrates=[],this.smoothSecondsLeft=null,this.timerHandler=setInterval(t.proxy(this.timer,this),1e3)},timer:function(){if(!(this.bitrates.length<3)){for(var t,e,n=0,i=0;i<this.bitrates.length;i++)n+=this.bitrates[i];t=n/this.bitrates.length,e=8*(this.total-this.loaded)/t,this.secondsLeft=e,null===this.smoothSecondsLeft?this.smoothSecondsLeft=e:(this.smoothSecondsLeft--,Math.abs(this.smoothSecondsLeft-this.secondsLeft)>=10?this.smoothSecondsLeft=e:e=this.smoothSecondsLeft),this.options.events.onTimeRemaining&&this.options.events.onTimeRemaining.call(this,e)}},cancel:function(){this._setState("canceled"),this.formData&&this.formData.jqXHR&&this.formData.jqXHR.abort(),clearInterval(this.timerHandler)},onAdd:function(t,e){var n=e.files[0];this.formData=e,this.setProgress(0),this._setState("file-selected"),this.allowedFiles.test(n.type)||this.allowedFiles.test(n.name)?(this.options.ui.fileName&&this.options.ui.fileName.text(n.name),this.options.ui.fileSize&&n.size&&this.options.ui.fileSize.text(this._humanizeBytes(n.size)),this.options.autoUpload&&this.start()):(this._setState("invalid-file"),alert("Selected file format is not supported, please select different file.")),this.options.events.onAdd&&this.options.events.onAdd.call(this,t,e)},removeFile:function(){if(!this.formData)return!1;this.formData=null,this._setState("pending-selection")},onProgress:function(t,e){this.bitrates.push(e.bitrate),this.loaded=t.loaded,this.total=t.total,this.options.events.onProgress?this.options.events.onProgress.call(this,t,e):t.total&&this.setProgress(t.loaded/t.total*100)},setProgress:function(t){this.options.ui.progress&&this.options.ui.progress.css("width",t+"%")},onDone:function(t,e){this._setState("complete"),this.options.events.onDone&&this.options.events.onDone.call(this,t,e),clearInterval(this.timerHandler)},onFail:function(t,e){this.setProgress(0),this._setState("failed"),this.options.events.onFail&&this.options.events.onFail.call(this,t,e),clearInterval(this.timerHandler)}},t.fn.seditionFileUpload=function(e){return t(this).data("seditionFileUpload",new sedition.SeditionFileUpload(t(this),e))}}(jQuery),function(t){t(function(){var e=t("#artwork-upload-list"),n=t("#show-artwork-upload-modal"),i=t(".wrong-file");e.find(".fu-cancel").on("click",function(e){e.preventDefault(),t(this).closest(".fu-view").data("dropzone").data("seditionFileUpload").cancel()}),t(".js-upload-artwork").each(function(){var o=t(this),a=t("#upload_widg_"+o.attr("id")).data("dropzone",o),r=a.find(".time-remaining"),s=5;o.on("dragover",function(){o.addClass("is-dragged-over")}),o.on("dragleave",function(t){this===t.target&&o.removeClass("is-dragged-over")}),o.seditionFileUpload({dropZone:o,ui:{container:a,fileSize:a.find(".bytes-uploaded"),fileName:a.find(".fu-filename"),progress:a.find(".fu-progress")},events:{onAdd:function(t,e){o.find(".filename").html(e.files[0].name)},onFail:function(){var i=t(".js-upload-artwork[data-state=file-selected]:first");i.length?i.data("seditionFileUpload").start():t(".fu-view[data-state=complete]").length?window.location="/studio/artworks":(e.modal("hide"),n.attr("disabled","disabled").addClass("disabled").html("Upload artwork"))},onSend:function(t,e){e.dataType&&"iframe"===e.dataType.substr(0,6)&&a.addClass("iframe-transport")},onDone:function(e,n){var i,o=0,a=this,r=(t(".js-upload-artwork[data-state=file-selected]:first"),this.$element.attr("action")+this.$element.find("#key").val().replace("${filename}",n.files[0].name));i=setInterval(function(){++o<=s?a.setProgress(100-s+o):clearInterval(i)},800),t.post("/studio/artworks/create_from_file",{_method:"POST",artwork:{s3_url:r,s3_file_type:n.files[0].type,s3_file_size:n.files[0].size},filename:n.files[0].name,format:"js"},function(t){clearInterval(i),a.setProgress(100),t.artwork&&t.artwork&&t.artwork.short_name&&(window.location=window.Routes.edit_studio_artwork_path(t.artwork.short_name))})},onProgress:function(t){var e=(100-s)/100;this.setProgress(t.loaded/t.total*100*e),this.options.ui.fileSize.html("<b>"+this._humanizeBytes(t.loaded)+"</b> out of "+this._humanizeBytes(t.total))},onTimeRemaining:function(t){t&&Math.round(t)&&t>5?r.html("Est. time remaining <b>"+this._formatTime(t)+"</b>"):r.html("Will finish in a moment...")}}});var l=o.data("seditionFileUpload");i.click(function(e){e.preventDefault(),t(".js-trigger-upload input").val(""),l.removeFile()}),o.find(".btn-start-upload").click(function(t){t.preventDefault(),l.start()})})})}(jQuery),function(t){sedition.ContactImporter=function(e){var n,i,o,a=t(e),r=a.attr("href")||a.data("path"),s=a.data("provider");return i={on_import:function(t,e){clearInterval(o),a.trigger("import_complete",[t,e])},on_importing:function(){a.trigger("importing")},on_fail:function(){a.trigger("import_fail")},on_auth:function(t,e){a.trigger("import_authed",[t,e])},popup_window:function(e,n,a){var r=window.open(e,"popup","width="+n+",height="+a+",scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0");o=setInterval(function(){!1!==r.closed&&(clearInterval(o),i.on_fail())},300),t("body").on("popup_close",function(){clearInterval(o)})}},n={yahoo:function(){t("body").on("yahoo_import_complete",function(t,e){i.on_import(e)}),i.popup_window(r,500,500)},gmail:function(){t("body").on("gmail_import_complete",function(t,e){i.on_import(e)}),i.popup_window(r,500,500)},file:function(){a.find("input[type=file]").fileupload({dataType:"json",autoUpload:!0,done:function(){i.on_import()},send:function(){i.on_importing()},fail:function(e,n){t(".upload-error").prepend(n.jqXHR.responseText),i.on_fail()}})}},"file"!=s?a.on("click",function(t){t.preventDefault(),a.is(".on")||(i.on_importing(),n[s]())}):n.file(),a},sedition.ContactImporter.callbacks={twitter:function(e,n,i){t("body").trigger("twitter_auth_complete",{uid:e,token:n,secret:i}).trigger("popup_close")},oauth:function(e,n){t("body").trigger("popup_close"),"gmail"==n?t("body").trigger("gmail_import_complete",e):"yahoo"==n&&t("body").trigger("yahoo_import_complete",e)}},t.fn.contactImporter=function(){return this.each(function(){t(this).data("importer")||t(this).data("importer",new sedition.ContactImporter(t(this)))})}}(jQuery),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});const contactsTemplate="\n<div class='importer-container-no-contacts'>\n  <div class='upload-error'></div>\n  <h2>\n    {{_ 'You do not have any contacts'}}\n  </h2>\n  <div class='import-options'>\n    <h3>\n      {{_ 'Import from'}}\n    </h3>\n    <a class='import-from-gmail' data-provider='gmail' href='/contacts/gmail'>\n      {{_ 'Gmail'}}\n    </a>\n    <a class='import-from-yahoo' data-provider='yahoo' href='/contacts/yahoo'>\n      {{_ 'Yahoo'}}\n    </a>\n    <a class='import-from-file' data-provider='file' href='javascript:void(0)'>\n      {{_ 'File'}}\n      <input class='file-select' data-provider='file' data-url='/user_contacts/create_from_file' name='uploaded_file' type='file' />\n    </a>\n  </div>\n</div>\n{{#each contacts}}<div class='contact js-contact'>\n  <div class='column column-select'>\n    {{#if excluded}}<input class='js-contact-select' data-user-contact-id='{{id}}' type='checkbox' />\n    {{else}}\n    <input checked='checked' class='js-contact-select' data-user-contact-id='{{id}}' type='checkbox' />{{/if}}\n  </div>\n  <div class='column column-name'>\n    <div class='name-box' data-resource='{{paths.resource}}' data-state='idle'>\n      {{#if name}}<a class='has-name edit-contact-name' href='#edit'>\n        {{name}}\n      </a>\n      {{else}}\n      <a class='has-name no-name edit-contact-name' href='#edit'>\n        {{_ 'Click to add a name'}}\n      </a>{{/if}}\n      <input class='text input-contact-name' placeholder='Contact name' type='text' />\n    </div>\n  </div>\n  <div class='column column-email'>\n    {{email}}\n  </div>\n  <div class='column column-actions'>\n    <span class='import-source-{{source}}'>\n      {{_ 'Source'}}\n    </span>\n  </div>\n  <div class='column column-delete'>\n    <a class='icon-cross delete-contact js-delete-contacts' data-id='{{id}}' href='#delete'></a>\n  </div>\n</div>\n{{/each}}\n";!function(t,n){t(".js-iframe-preview").each(function(){var e,n,i=t(this),o=i.data("scale")||1,a=t("<iframe />").attr("src",i.data("url")),r=function(){var t=a[0].contentWindow.document.body.offsetHeight;a.css("height",t)};a.load(function(){e=a.contents().find(".js-artist-message-container"),n=e.find(".js-artist-message"),r()}),a[0].updateMessage=function(t){if(e)0==(t=_.escape(t.trim()).replace(/(?:\n\r?|\r\n?)/g,"<br>")).length?e.hide():(e.show(),n.html(t)),r();else{var i=this;setTimeout(function(){a[0].updateMessage.call(i,t)},100)}},a.css("scale",o),i.append(a)}),t(".js-email-message").each(function(){var e=t(this),n=t(".js-iframe-preview iframe");e.on("change keyup",function(){n[0].updateMessage(e.val())}),e.change()});var i=t(".js-importer-modal"),o=t(".selected-contacts"),a=t(".total-contacts"),r=t(".contacts-body"),s=t(".contacts-body-overlay"),l=t(".js-select-all"),c={closeContacts:function(){i.modal("hide")},showLoading:function(t){s.find(".loading-text").html(t),s.show()},hideLoading:function(){s.hide()},refreshContacts:function(){var e=this,n=r.data("resource");this.showLoading("Loading contacts..."),t.getJSON(n,function(t){c.addContacts(t.contacts),e.hideLoading()})},addContacts:function(e,n){privateViewSetupPage.contactsManager.refresh();var o,a,s=r;return i.attr("data-contacts-count",e.length),a=Handlebars.compile(contactsTemplate),o=t(a({contacts:e})),n?(o.addClass("contact-loading"),s.prepend(o),s.find(".no-contacts").remove()):s.html(o),c.refreshCount(),0===e.length&&(c.importContacts(i.find(".import-from-gmail")),c.importContacts(i.find(".import-from-yahoo")),c.importContacts(i.find(".import-from-file"))),o},refreshCount:function(){var t=r.find(".js-contact").length,e=r.find("input:checked").length,n=e==t;l.prop("checked",n),o.html(e),a.html(t)},pruneContacts:function(e){var n,i=t(".contact-prune-box").data("resource");n={user_contact_ids:t(".js-contact-select:not(:checked)").map(function(){return t(this).data("user-contact-id")}).get()||[]},c.refreshCount(),t.ajax({dataType:"json",type:"PATCH",url:i,data:n,success:e})},importContacts:function(e){var n=this;e.each(function(){t(this).contactImporter().on("import_complete",function(){c.refreshContacts(),n.hideLoading()}).on("importing",function(){n.showLoading("Importing contacts...")}).on("import_fail",function(){n.hideLoading()})})},initStringContact:function(){var e,n=t(".form-manual-contact"),i=t(".input-manual-email"),o=t(".input-manual-name");e=function(){var e=String(i.val()).trim(),a=o.val();i.val(e),e.match(/^\S+@\S+\.\S+$/)&&(t.ajax({dataType:"json",type:"POST",url:n.attr("action"),data:n.serialize(),success:function(){c.addContacts([{email:e,name:a,source:"manual"}],!0)}}),i.val(""),o.val(""))},n.on("submit",function(t){t.preventDefault(),e()})},initEditContact:function(){var n=function(e){e.preventDefault();var n=t(this).parents(".name-box"),i=t.trim(t(this).val());if(n.attr("data-state","idle"),""!==i){var o=n.data("resource");t.ajax({dataType:"json",type:"PUT",url:o,data:{user_contact:{name:i}}}),n.find(".edit-contact-name").text(i).removeClass("no-name")}};t(".contact-prune-table").on("click",".edit-contact-name",function(e){e.preventDefault();var n=t(this).parents(".name-box");n.attr("data-state","editing"),n.find(".input-contact-name").focus()}),t("body").on("blur",".input-contact-name",n),t(".contact-prune-table").on("keyup",".input-contact-name",function(t){t.preventDefault(),13===e.which&&n.call(this,e)})},deleteContact:function(e){e.preventDefault();var n=t(e.target),i=function(){t.ajax({dataType:"json",type:"DELETE",url:"/user_contacts/"+n.data("id"),success:function(){if("all"===n.data("id"))t(".importer-container .recipients .row .col-12").html('<a id="add-recipients" class="btn bg-action" href="">Add guests</a>'),t(".importer-container .recipients .total-contacts").html(0),t(".importer-container .recipients .selected-contacts").html(0),c.closeContacts(),privateViewSetupPage.contactsManager.refresh();else{var e=n.parents(".js-contact").first().find(".column-select input").first().attr("checked");t(".importer-container .recipients .total-contacts").html(parseInt(t(".importer-container .recipients .total-contacts").html())-1),e&&t(".importer-container .recipients .selected-contacts").html(parseInt(t(".importer-container .recipients .selected-contacts").html())-1),n.parents(".js-contact").first().hide(function(){t(this).remove()})}}})};"all"===n.data("id")?bootbox.confirm("Are you sure?",function(t){if(t)return i()}):i()}};c.initStringContact(),c.initEditContact(),t(".edit_artwork_campaign").on("submit",function(){return parseInt(a.html(),10)>0}),i.on("click",".js-delete-contacts",function(t){t.preventDefault(),c.deleteContact(t)}).on("show",c.refreshContacts.bind(c));var d=Backbone.Collection.extend({url:function(){if(!this._artworkId)throw"URL requires Artwork ID";return window.Routes.list_contacts_studio_artwork_artwork_campaign_path(this._artworkId,{wrap:!1})},initialize:function(t,e){this.options=e,this._artworkId=e.artworkId},guests:function(){return this.where({excluded:!1})}}),u=Backbone.View.extend({events:{"click .js-save":"onSaveClick","click .js-select-all":"onSelectAllClick","change .js-contact-select":"render"},initialize:function(){this._artworkId=this.$el.data("artwork-id"),this.collection=new d([],{artworkId:this._artworkId}),this.collection.fetch({reset:!0}),c.importContacts(this.$(".trigger-import"))},guestCount:function(){return this.collection.guests().length},refresh:function(){this.collection.fetch({reset:!0})},render:function(){c.refreshCount()},onSelectAllClick:function(t){var e=t.currentTarget.checked;this.$el.find(".js-contact-select").prop("checked",e),this.render()},onSaveClick:function(t){t.preventDefault(),c.pruneContacts(_.bind(this.refresh,this))}}),f=Backbone.View.extend({events:{"click .js-contact-agreement":"render"},initialize:function(){that=this,this._minGuests=20,this.contactsManager=new u({el:this.$(".js-importer-modal")[0]}),this.listenTo(this.contactsManager.collection,"reset",this.render),this.$count=this.$(".js-count"),this.render()},render:function(){var e=this.contactsManager.guestCount();minGuestCountMet=e>=this._minGuests,checkedContactAgreement=t(".js-contact-agreement").is(":checked"),allowPublish=minGuestCountMet&&checkedContactAgreement,this.$count.html(e),this.$el.toggleClass("state-allow-publish",allowPublish),t(".js-btn-private-publish").prop("disabled",!allowPublish)}});i.length>0&&(n.privateViewSetupPage=new f({el:t(".js-private-view-setup")[0]}))}(jQuery,window),function(t){var e={bgloop:{repeat:!0,mute:!0,autostart:!0,controls:!1,preload:"auto",displaytitle:!1,displaytitle:!1,width:"100%",height:"100%",stretching:"fill"}};sedition.Video=function(n,i){var o=this,a=t(n),r="<div class='jwplayer'></div>";(i=i||{}).prepend?a.prepend(r):a.append(r);var s=a.attr("id"),l=a.children(".jwplayer").attr("id",s+"-jwplayer"),c=a.data(),d=i.preset?e[i.preset]:{},u=c.file,f=c.image,p=c.playlist,h=(c.adaptiveStream,t.extend({},t.fn.video.defaults,d,i));u&&f?h.playlist=[{file:u,image:f}]:u?h.file=u:p&&(h.playlist=p),h.forceLoop&&(h.plugins||(h.plugins={}));var m=jwplayer(l.attr("id")).setup(h);return m.on("playlistComplete",function(){this.load(this.config.playlist)}).on("ready",i.onReady).on("error setupError",function(t){i.onError&&i.onError.call(o,t),window.bugsnag.notify({name:"jwplayer setupError",message:t.message}),document.getElementsByClassName("jw-title-primary")[0].innerHTML=t.message}),a.data("player",m),m}}(jQuery),function(t){t.fn.video=function(t){return this.each(function(){new sedition.Video(this,t)})},t.fn.video.defaults={preset:"",playlist:undefined,forceLoop:!0,autostart:!0,repeat:!1,width:730,height:411,smoothing:!0,icons:!0,wmode:"transparent",hlshtml:!0,flashplayer:"//ssl.p.jwpcdn.com/player/v/8.1.2/jwplayer.flash.swf",controlbar:{position:"over"}}}(jQuery),function(){$(function(){var t,e,n,i,o,a;if(t=$("#account-artist-company-edit-form"),e=$(".account-invoice-form"),t.length||e.length)return(i=$("#payment-method")).change(function(){return $(".payment-method-controls").hide(),$(".payment-method-controls."+$(this).val()).show()}),$("#artist_company_bank_sortcode").val()?i.val("bank").change():i.val("paypal").change(),$(".btn-submit-invoice").click(function(){return confirm("Are you sure you want to submit this invoice?")}),o=$("#registration-same-as-postal"),n=$(".registred-office-address-fields"),o.on("click change",function(){return o.is(":checked")?n.hide():n.show()}),a=!0,$(".postal-address-fields").find("input, select").each(function(){var t,e,n;if(n=(n=(t=$(this)).attr("name").match(/\[(.+?)\]\[(.+?)\]/))[2],e=$('[name="artist_company[registered_address_attributes]['+n+']"]'),t.val()!==e.val())return a=!1,!1}),a?(o.attr("checked","checked"),n.hide()):(o.removeAttr("checked"),n.show())})}.call(this),function(){jQuery,sedition.Tracking={tradeArtworkBought:function(){},tradeArtworkSold:function(){},bidPlaced:function(){},listingPlaced:function(){}}}.call(this),function(){var t
;(t=jQuery)(".gift-card-cta").click(function(e){return e.preventDefault(),t("html, body").animate({scrollTop:t(".section-cards").offset().top},"slow")})}.call(this),function(){var t,e=$("[data-parallax-speed]");if(e.length){var n=function(){t=$(window).scrollTop(),e.each(o)},i=function(e){var n=e.data("parallax-speed")||1;return Math.floor(t*(n-1))},o=function(e,n){var o=$(n),a=o.data();if(!(t>=a.parallaxStop)){var r=i(o);o.css("transform","translateY("+r+"px)")}};$(window).on("scroll.parallax",n)}}(),function(t){window.sedition||(window.sedition={}),window.sedition.lazyLoadImages=function(e){e.find(".js-lazy-image").each(function(){var e=t(this),n=e.attr("src")||e.data("src");if(n){var i=new Image;t(i).load(function(){e.addClass("is-loaded"),e.data("src")&&e.css("background-image","url("+n+")")}).error(function(){e.addClass("is-loaded is-error")}),i.src=n}})}}(jQuery),function(t){t(".js-profile-edit-form").each(function(){var e=t(this).find(".js-profile-submit");t(".js-image-uploader").each(function(){var n=t(this);n.delegate(".js-image-uploader__remove","click",function(){n.removeClass("image-uploader--has-image").find(".js-image-uploader__preview").css("background-image","").attr("src",""),n.find(".file-select.required").removeClass("file-select--present"),"banner"==n.data("type")&&t(".js-profile-header-background").css("background-image",""),t.ajax({type:"PUT",url:n.data("upload-url"),data:{format:"js","delete":1}})}),n.seditionFileUpload({events:{onDone:function(i,o){var a=o.result;(n.addClass("image-uploader--has-image").removeClass("image-uploader--uploading"),a.path)&&("banner"==n.data("type")&&t(".js-profile-header-background").css("background-image","url("+a.path+")"),n.find(".js-image-uploader__preview").css("background-image","url("+a.path+")").attr("src",a.path),n.find(".file-select.required").addClass("file-select--present"),e.removeAttr("disabled"),t(".js-profile-edit-form").data("validation").validateForm())},onSend:function(){n.addClass("image-uploader--uploading"),e.attr("disabled","disabled")},onFail:function(){n.removeClass("image-uploader--uploading"),e.removeAttr("disabled"),t(".js-profile-edit-form").data("validation").validateForm()}},allowedFiles:/(\.|\/)(jpe?g|png)$/i,autoUpload:!0,fileuploadOptions:{type:"PUT",url:n.data("upload-url"),formData:{_method:"PUT",file_upload:!0}}})})})}(jQuery),
/*!
 * clipboard.js v1.6.1
 * https://zenorocha.github.io/clipboard.js
 *
 * Licensed MIT Â© Zeno Rocha
 */
function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=t()}}(function(){var t;return function e(t,n,i){function o(r,s){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){var n=t[r][1][e];return o(n||e)},d,d.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(t,e){function n(t,e){for(;t&&t.nodeType!==i;){if(t.matches(e))return t;t=t.parentNode}}var i=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var o=Element.prototype;o.matches=o.matchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector}e.exports=n},{}],2:[function(t,e){function n(t,e,n,o,a){var r=i.apply(this,arguments);return t.addEventListener(n,r,a),{destroy:function(){t.removeEventListener(n,r,a)}}}function i(t,e,n,i){return function(n){n.delegateTarget=o(n.target,e),n.delegateTarget&&i.call(t,n)}}var o=t("./closest");e.exports=n},{"./closest":1}],3:[function(t,e,n){n.node=function(t){return t!==undefined&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return t!==undefined&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},{}],4:[function(t,e){function n(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!r.string(e))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(t))return i(t,e,n);if(r.nodeList(t))return o(t,e,n);if(r.string(t))return a(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function i(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function o(t,e,n){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,n)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,n)})}}}function a(t,e,n){return s(document.body,t,e,n)}var r=t("./is"),s=t("delegate");e.exports=n},{"./is":3,delegate:2}],5:[function(t,e){function n(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var i=window.getSelection(),o=document.createRange();o.selectNodeContents(t),i.removeAllRanges(),i.addRange(o),e=i.toString()}return e}e.exports=n},{}],6:[function(t,e){function n(){}n.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function i(){o.off(t,i),e.apply(n,arguments)}var o=this;return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,o=n.length;i<o;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],o=[];if(i&&e)for(var a=0,r=i.length;a<r;a++)i[a].fn!==e&&i[a].fn._!==e&&o.push(i[a]);return o.length?n[t]=o:delete n[t],this}},e.exports=n},{}],7:[function(e,n,i){!function(o,a){if("function"==typeof t&&t.amd)t(["module","select"],a);else if(void 0!==i)a(n,e("select"));else{var r={exports:{}};a(r,o.select),o.clipboardAction=r.exports}}(this,function(t,e){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(e),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(){function t(e){i(this,t),this.resolveOptions(e),this.initSelection()}return r(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=t.action,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=(0,o["default"])(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,o["default"])(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(t!==undefined){if(!t||"object"!==(void 0===t?"undefined":a(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s})},{select:5}],8:[function(e,n,i){!function(o,a){if("function"==typeof t&&t.amd)t(["module","./clipboard-action","tiny-emitter","good-listener"],a);else if(void 0!==i)a(n,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var r={exports:{}};a(r,o.clipboardAction,o.tinyEmitter,o.goodListener),o.clipboard=r.exports}}(this,function(t,e,n,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}var c=o(e),d=o(n),u=o(i),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),p=function(){function t(e,n){a(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return s(t,d["default"]),f(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,u["default"])(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new c["default"]({action:this.action(e),target:this.target(e),text:this.text(e),trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return l("action",t)}},{key:"defaultTarget",value:function(t){var e=l("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return l("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach(function(t){n=n&&!!document.queryCommandSupported(t)}),n}}]),t}();t.exports=p})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)}),function(t,e){t(function(){var n=t("html");sedition.lazyLoadImages(n),t(".js-fullscreen").fullscreen(),t(".alert").alert(),t(".autofocus:first").focus(),t(".js-input-icon").seditionInputIcon(),t(".full-page-slider").slider({slideshowInterval:8}),t(".js-timeago").timeago(),t(".maxlength").maxlength(),t(".focus:first").focus(),t(".close-pv").click(function(){t(".private-view-gateway-outer").hide(),t(".artwork-outer-container").removeClass("has-private-view-gateway")}),bootbox.setBtnClasses({CANCEL:"btn--border-light",OK:"btn--border-light",CONFIRM:"btn--border-cta"}),t(".simple_form, .js-validate-form").seditionValidate({validators:[{selector:".password",validate:function(t){return t.length>5},message:"Must be at least 6 characters."}],onValidateForm:function(t){this.$el.is(".form-check-validity")&&(t?this.$el.find('[type="submit"]').removeAttr("disabled"):this.$el.find('[type="submit"]').attr("disabled","disabled"))}}),t(".buy-physical-gift").on("submit",function(e){var n=t(this),i=n.closest(".physical-gift-card");e&&e.preventDefault(),i.addClass("state-adding"),t.post(n.attr("action"),n.serialize()).done(function(){i.addClass("state-added")}).fail(function(){i.addClass("state-error")}).always(function(){i.removeClass("state-adding")})}),t(".physical-gift-card .link-continue").click(function(e){e&&e.preventDefault();t(this);t(this).closest(".physical-gift-card").removeClass("state-added state-adding state-failed")}),t(".simulate-click").on("click",function(){document.location=t(this).data("href")}),sedition.Facebook.bindConnectButtonClick(),t(".js-follow").follow(),t(".js-entity-tabs").on("click","a",function(e){e.preventDefault(),t(this).tab("show")}),t('select[rel="autocomplete"]').seditionLocationTypeahead(),t(".contact-import-link").click(function(n){n.preventDefault(),e.open(t(n.target).attr("href"),"popup","width=500,height=500,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0")}),t(".js-toggle-section-trigger").toggleSection(),t(".excerpt:not(.disable)").excerpt(),t("form[data-confirmation]").on("submit",function(e,n){if(!n){e.preventDefault();var i=t(this);bootbox.confirm(i.data("confirmation"),i.data("cancel")||"Cancel",i.data("ok-text")||"OK",function(t){t&&i.trigger("submit",!0)})}}),t(".js-notification-callout--private-view").each(function(){var e=t(this),n=e.data("id"),i=e.data("type"),o="popup-dismissed-"+i+"-"+n,a=sedition.user.storage.session.get(o),r=!1;e.find(".js-notification-callout__dismiss").click(function(){sedition.user.storage.session.set(o,!0),e.removeClass("notification-callout--active")}),"collection"==i&&(r=sedition.user.taste.artworkGroup(n)>0),"artwork"==i&&(r=sedition.user.taste.artwork(n)>0),r||a||setTimeout(function(){e.addClass("notification-callout--active")},1e3)})}),function(){var n=navigator.userAgent,i=n.match(/iPhone/i)||n.match(/iPod/i),o=n.match(/android/i);if(e.offerMobileApp&&(i||o)){var a,r=t("html"),s=Handlebars.compile("<div class='splash-screen-mobile-app'><header><h1>Get the Sedition App</h1><p>Discover, buy and enjoy art,<br />optimised for your mobile device.</p></header><a class='btn bg-cta'>Get the App</a><div class='alt-action'><a class='continue' href='#'>or continue to<span>seditionart.com</span></a></div></div>"),l=t(s()),c=7776e3;if(!Cookies.get("hide-device-app-banner")){var d=t('meta[name="viewport"]'),u=d.attr("content");d.attr("content","width=device-width, user-scalable=no"),r.addClass("device-splash-active"),i?(r.addClass("device-splash-iphone"),a="https://itunes.apple.com/us/app/sedition-art/id468642152?ls=1&mt=8"):(r.addClass("device-splash-android"),a="https://play.google.com/store/apps/details?id=com.sedition"),t("body").prepend(l),l.on("click","header, .bg-cta",function(t){t&&t.preventDefault(),Cookies.set("hide-device-app-banner",1,c),e.location=a}).on("click",".continue",function(n){n&&n.preventDefault(),Cookies.set("hide-device-app-banner",1,c),l.hide(),o?e.location.reload(!0):(t("html").removeClass("device-splash-active device-splash-iphone device-splash-android"),d.attr("content",u))})}}}(),t(".js-show-image").each(function(){var e=t(this);e.click(function(n){n.preventDefault();var i=t("<div />"),o='<img style="width: 100%; max-width: 1000px" src="%{url}" />'.replace("%{url}",e.attr("href"));(i=t('<div class="modal modal--fluid hide fade in" style="max-width: 1000px; margin: 0 auto">'+o+"</div>")).on("hide",function(){setTimeout(i.remove.bind(i),500)}),t("body").append(i),i.modal()})}),t(document).ajaxComplete(function(n,i){if(500==i.status)if(e._ajaxErrorHandled)e._ajaxErrorHandled=!1;else{var o=t("#error-modal");i.responseJSON&&i.responseJSON.error?message=i.responseJSON.error:message=o.data("message"),o.find(".js-error-modal-content").html(message),o.modal("show")}}),t(".js-mark-on-load").each(function(){t(this).addClass("is-loaded")}),t(".js-disable-on-click").each(function(){t(this).click(function(){var e=t(this);setTimeout(function(){e.attr("disabled",!0)},100)})});var n=function(t,e){var n=t.find(".tooltip");n.find(".tooltip__inner").html(e),n.removeClass("tooltip--invisible"),t.one("mouseout",function(){setTimeout(function(){n.addClass("tooltip--invisible")},2e3)})};new Clipboard(".js-copy-to-clipboard").on("success",function(e){var i=t(e.trigger);n(i,__("Copied"))}).on("error",function(e){var i=t(e.trigger);n(i,__("Text selected. Press Ctrl+C (Windows) or Cmd+C (Mac) to copy"))})}(jQuery,window);